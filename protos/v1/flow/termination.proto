syntax = "proto3";

package v1;

import "v1/flow/k8s.proto";

option go_package = "v1/flow";

// Termination specification, it defines how to handle failures, job runtime, and cleanup policy.
message Termination {
    // Max retries for a specific run
    int32 maxRetries = 1;

    // A TTL definition
    int32 ttl = 2;

    // A timeout in seconds
    int32 timeout = 3;

    // Culling configuration
    Culling culling = 4;

    // Activity probe configuration
    ActivityProbe probe = 5;

    // Pod failure policy configuration
    PodFailurePolicy podFailurePolicy = 6;
}

// Culling specification
message Culling {
    // Timeout in seconds
    int32 timeout = 1;
}

// ActivityProbe specification
message ActivityProbe {
    // Exec probe
    ActivityProbeExec exec = 1;

    // Http probe
    ActivityProbeHttp http = 2;
}

// ActivityProbeExec specification
message ActivityProbeExec {
    // Command to execute
    repeated string command = 1;
}

// ActivityProbeHttp specification
message ActivityProbeHttp {
    // Path to access on the HTTP server
    string path = 1;

    // Port to access on the HTTP server
    int32 port = 2;
}
